<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Desk | Rupa Travels</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .admin-container { padding: 40px; max-width: 1200px; margin: auto; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
        th, td { padding: 15px; border-bottom: 1px solid #ddd; text-align: left; }
        th { background-color: #004d40; color: white; }
        .status-pending { color: orange; font-weight: bold; }
        .whatsapp-btn { 
            background-color: #25D366; 
            color: white; 
            padding: 8px 12px; 
            text-decoration: none; 
            border-radius: 5px; 
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <h1>RUPA TRAVEL AGENCY</h1>
        <p>GUWAHATI CONTROL DESK</p>
        
        <table>
            <thead>
                <tr>
                    <th>Traveler</th>
                    <th>Destination</th>
                    <th>Guests</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="bookingsTable">
                </tbody>
        </table>
    </div>

    <script>
        async function fetchBookings() {
            try {
                // Connecting to your live Render brain
                const response = await fetch('https://rupa-travels.onrender.com/api/admin/bookings');
                const bookings = await response.json();
                const tableBody = document.getElementById('bookingsTable');
                tableBody.innerHTML = '';

                bookings.forEach(booking => {
                    // This creates the professional WhatsApp message format we discussed
                    const message = `Hello ${booking.name}, this is Rupa Travel Agency! ✈️%0A%0AWe received your booking request for ${booking.destination}.%0A%0ADetails:%0A- Guests: ${booking.guests}%0A- Status: ${booking.status}%0A%0APlease let us know a good time to call you to finalize the itinerary!`;
                    
                    const whatsappUrl = `https://wa.me/${booking.phone}?text=${message}`;

                    const row = `
                        <tr>
                            <td><strong>${booking.name}</strong><br>${booking.phone}</td>
                            <td>${booking.destination}</td>
                            <td>${booking.guests}</td>
                            <td class="status-pending">${booking.status}</td>
                            <td>
                                <a href="${whatsappUrl}" target="_blank" class="whatsapp-btn">WHATSAPP</a>
                            </td>
                        </tr>
                    `;
                    tableBody.innerHTML += row;
                });
            } catch (error) {
                console.error('Error fetching bookings:', error);
            }
        }

        // Run this when the page opens
        fetchBookings();
    </script>
</body>
</html>